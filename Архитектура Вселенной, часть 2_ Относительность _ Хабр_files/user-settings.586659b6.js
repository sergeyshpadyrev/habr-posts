(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user-settings"],{"0578":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isMounted?a("FormBuilder",e._g(e._b({},"FormBuilder",e.$attrs,!1),e.$listeners)):a("TMPlaceholder",{attrs:{times:2,type:"form"}})},o=[],s=a("2b0e"),n=a("5188");s["default"].component("FormBuilder",()=>a.e("chunk-2d0c0c0a").then(a.t.bind(null,"42b8",7)));var l={name:"TMFormBuilder",components:{TMPlaceholder:n["a"]},data(){return{isMounted:!1}},mounted(){this.isMounted=!0}},r=l,T=a("2877"),m=Object(T["a"])(r,i,o,!1,null,null,null);t["a"]=m.exports},4365:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TMPage",{staticClass:"user-settings",scopedSlots:e._u([{key:"default",fn:function(){return[a("div",{staticClass:"tm-page__top"},[a("TMSectionName",{attrs:{name:e.msg("SETTINGS")}}),e._v(" "),a("TMUserSettingsTabs")],1),e._v(" "),a("div",{staticClass:"user-settings__form"},[e.isDataLoading?a("TMPlaceholder",{staticClass:"tm-form__placeholder",attrs:{times:6,type:"form"}}):a("TMFormBuilder",{attrs:{disabled:e.isSubmitLoading,fields:e.fields,"initial-data":e.initialData,lang:e.langOptions.hl,"submit-label":e.msg("SETTINGS_PROFILE_SUBMIT"),"validate-on-blur":""},on:{submit:e.proceedForm,"update:data":e.onDataUpdate,"update:tempData":e.formUpdateTempData}})],1)]},proxy:!0}])})},o=[],s=a("2f62"),n=a("0578"),l=a("ff3c"),r=a("5188"),T=a("2517"),m=a("6223"),c=a("6012");const I={viewCommentsRefresh:!1,enableShortcuts:!1,hideAdv:!1},S=e=>[{className:"tm-section-light",name:"interactions",label:e("SETTINGS_MISC_INTERACTIONS"),type:"BaseSection"},{className:"tm-checkbox",name:"viewCommentsRefresh",label:e("SETTINGS_MISC_REFRESH_PANEL"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"enableShortcuts",label:e("SETTINGS_MISC_HOTKEYS"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-section-light",name:"disableAds",label:e("SETTINGS_MISC_DISABLE_ADS"),type:"BaseSection"},{className:"tm-checkbox",name:"hideAdv",label:e("SETTINGS_MISC_YES_IT_WOULD_BE_NICE"),type:"BaseCheckbox",validation:{required:!1}}],E={emailNews:!1,emailUIExperience:!1,emailNewMessages:!1,emailCommentReply:!1,emailMention:!1,emailFollowerAdd:!1,trackerBadget:!1,trackerShowFollowersBookmarks:!1,afTrackerPostAdd:!1,afTrackerPostCommentAdd:!1,afTrackerPostFavoriteAdd:!1,afEmailPostAdd:!1,afEmailPostCommentAdd:!1,afEmailPostFavoriteAdd:!1,digestFrequency:""},_=e=>[{className:"tm-section",name:"newComments",label:e("SETTINGS_NOTIFICATIONS_NEW_COMMENTS"),type:"BaseSection"},{className:"tm-section-light",name:"toMyPosts",label:e("SETTINGS_NOTIFICATIONS_TO_MY_POSTS"),type:"BaseSection"},{className:"tm-checkbox",name:"afTrackerPostAdd",label:e("SETTINGS_NOTIFICATIONS_TRACKER"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"afEmailPostAdd",label:e("SETTINGS_NOTIFICATIONS_EMAIL"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-section-light",name:"toPostsWithComments",label:e("SETTINGS_NOTIFICATIONS_TO_POSTS_WITH_COMMENTS"),type:"BaseSection"},{className:"tm-checkbox",name:"afTrackerPostCommentAdd",label:e("SETTINGS_NOTIFICATIONS_TRACKER"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"afEmailPostCommentAdd",label:e("SETTINGS_NOTIFICATIONS_EMAIL"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-section-light",name:"toBookmarkedPosts",label:e("SETTINGS_NOTIFICATIONS_TO_BOOKMARKED_POSTS"),type:"BaseSection"},{className:"tm-checkbox",name:"afTrackerPostFavoriteAdd",label:e("SETTINGS_NOTIFICATIONS_TRACKER"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"afEmailPostFavoriteAdd",label:e("SETTINGS_NOTIFICATIONS_EMAIL"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-section-light",name:"sendMeEmails",label:e("SETTINGS_NOTIFICATIONS_SEND_ME_EMAILS"),type:"BaseSection"},{className:"tm-checkbox",name:"emailNews",label:e("SETTINGS_NOTIFICATIONS_NEWS"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"emailUIExperience",label:e("SETTINGS_NOTIFICATIONS_NEW_EXPERIENCE"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"emailNewMessages",label:e("SETTINGS_NOTIFICATIONS_NEW_MESSAGES"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"emailCommentReply",label:e("SETTINGS_NOTIFICATIONS_NEW_COMMENTS_REPLY"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"emailMention",label:e("SETTINGS_NOTIFICATIONS_NEW_MENTION"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"emailFollowerAdd",label:e("SETTINGS_NOTIFICATIONS_NEW_FOLLOWER"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-section-light",name:"sendMeTrackerEmails",label:e("SETTINGS_NOTIFICATIONS_TRACKER_SETTINGS"),type:"BaseSection"},{className:"tm-checkbox",name:"trackerBadget",label:e("SETTINGS_NOTIFICATIONS_TRACKER_BADGE"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-checkbox",name:"trackerShowFollowersBookmarks",label:e("SETTINGS_NOTIFICATIONS_FOLLOWERS_BOOKMARKS"),type:"BaseCheckbox",validation:{required:!1}},{className:"tm-select",label:e("SETTINGS_NOTIFICATIONS_DIGEST"),name:"digestFrequency",type:"BaseSelect",validation:{required:!1},options:[{name:e("SETTINGS_NOTIFICATIONS_DIGEST_NEVER"),value:null},{name:e("SETTINGS_NOTIFICATIONS_DIGEST_DAY"),value:"day"},{name:e("SETTINGS_NOTIFICATIONS_DIGEST_WEEK"),value:"week"},{name:e("SETTINGS_NOTIFICATIONS_DIGEST_MONTH"),value:"month"}]}],N={showContacts:"ALL",showActivity:"ALL",inboxAccess:"ALL"},d=e=>[{className:"tm-radio",label:e("SETTINGS_PROFILE_SHOW_CONTACTS"),name:"showContacts",type:"BaseRadio",validation:{required:!1},options:[{name:e("SETTINGS_PROFILE_TO_EVERYONE"),value:"ALL"},{name:e("SETTINGS_PROFILE_TO_FOLLOWING"),value:"FOLLOWING"}]},{className:"tm-radio",label:e("SETTINGS_PROFILE_INBOX_ACCESS"),name:"inboxAccess",type:"BaseRadio",validation:{required:!1},options:[{name:e("SETTINGS_PROFILE_FROM_EVERYONE"),value:"ALL"},{name:e("SETTINGS_PROFILE_FROM_FOLLOWERS"),value:"FOLLOWING"}]},{className:"tm-radio",label:e("SETTINGS_PROFILE_SHOW_ACTIVITY"),name:"showActivity",type:"BaseRadio",validation:{required:!1},options:[{name:e("SETTINGS_PROFILE_TO_EVERYONE"),value:"ALL"},{name:e("SETTINGS_PROFILE_TO_FOLLOWERS"),value:"FOLLOWERS"}]}],u={lang:"",avatarImageUrl:"",fullname:"",gender:"",birthdayDay:"",birthdayMonth:"",birthdayYear:"",contacts:[],paymentYandexMoney:"",paymentPayPalMe:"",paymentWebmoney:"",description:""},h=e=>[{name:e,value:null,htmlAttrs:{disabled:!0}}],p=(e,t=[],a=[],i=[],o=[])=>[{className:"tm-input",name:"lang",type:"BaseHidden",position:{row:"1",column:"1"}},{className:"tm-file",description:e("SETTINGS_PROFILE_AVATAR_HINT"),name:"avatarImageUrl",label:e("SETTINGS_PROFILE_AVATAR"),type:"BaseFile",validation:{maxSize:1e6,maxWidth:5e3,maxHeight:5e3},position:{row:"1 / 3",column:"1 / 7"},breakpoint:{1024:{position:{row:"1 / 5",column:"5 / 7"}}},htmlAttrs:{accept:"image/*"}},{className:"tm-input",label:e("SETTINGS_PROFILE_REALNAME"),description:e("SETTINGS_PROFILE_REALNAME_HINT"),name:"fullname",type:"BaseInput",validation:{required:!1,minLength:1,maxLength:40},position:{row:"3",column:"1 / 7"},breakpoint:{1024:{position:{row:"1",column:"1 / 4"}}}},{type:"DynamicInputs",name:"workPlaces",addLabel:null,label:e("SETTINGS_PROFILE_WORKPLACE"),restoreText:e("SETTINGS_PROFILE_WORKPLACE_PLACEHOLDER"),restoreLabel:e("SETTINGS_PROFILE_WORKPLACE_PLACEHOLDER_ACTION"),fields:[{name:"name",type:"BaseInput",disabled:!0,validation:{required:!1}}],position:{row:"4",column:"1 / 7"},breakpoint:{1024:{position:{row:"2",column:"1 / 4"}}}},{className:"tm-input",label:e("SETTINGS_PROFILE_SPECIALITY"),description:e("SETTINGS_PROFILE_SPECIALITY_HINT"),name:"speciality",type:"BaseInput",validation:{required:!1,minLength:1,maxLength:50},position:{row:"5",column:"1 / 7"},breakpoint:{1024:{position:{row:"3",column:"1 / 4"}}}},{className:"tm-select",label:e("SETTINGS_PROFILE_GENDER"),name:"gender",type:"BaseSelect",validation:{required:!1},position:{row:"6",column:"1 / 7"},breakpoint:{1024:{position:{row:"4",column:"1 / 2"}}},options:[{name:e("SETTINGS_PROFILE_GENDER_OTHER"),value:"0"},{name:e("SETTINGS_PROFILE_GENDER_MALE"),value:"1"},{name:e("SETTINGS_PROFILE_GENDER_FEMALE"),value:"2"}]},{className:"tm-select",label:e("SETTINGS_PROFILE_BIRTH_DATE"),name:"birthdayDay",type:"BaseSelect",validation:{required:!1},position:{row:"7",column:"1 / 7"},breakpoint:{1024:{position:{row:"4",column:"2 / 3"}}},options:[{name:e("SETTINGS_PROFILE_BIRTH_DAY"),value:""},...Array.from(Array(31).keys()).map(e=>({name:e+1,value:e+1}))]},{className:"tm-select",name:"birthdayMonth",type:"BaseSelect",validation:{required:!1},position:{row:"8",column:"1 / 7"},breakpoint:{1024:{position:{row:"4",column:"3 / 4"}}},options:[{name:e("SETTINGS_PROFILE_BIRTH_MONTH"),value:""},{name:e("CALENDAR_MONTH_JANUARY_TITLE"),value:1},{name:e("CALENDAR_MONTH_FEBRUARY_TITLE"),value:2},{name:e("CALENDAR_MONTH_MARCH_TITLE"),value:3},{name:e("CALENDAR_MONTH_APRIL_TITLE"),value:4},{name:e("CALENDAR_MONTH_MAY_TITLE"),value:5},{name:e("CALENDAR_MONTH_JUNE_TITLE"),value:6},{name:e("CALENDAR_MONTH_JULY_TITLE"),value:7},{name:e("CALENDAR_MONTH_AUGUST_TITLE"),value:8},{name:e("CALENDAR_MONTH_SEPTEMBER_TITLE"),value:9},{name:e("CALENDAR_MONTH_OCTOBER_TITLE"),value:10},{name:e("CALENDAR_MONTH_NOVEMBER_TITLE"),value:11},{name:e("CALENDAR_MONTH_DECEMBER_TITLE"),value:12}]},{className:"tm-select",name:"birthdayYear",type:"BaseSelect",validation:{required:!1},position:{row:"9",column:"1 / 7"},breakpoint:{1024:{position:{row:"4",column:"4 / 5"}}},options:[{name:e("SETTINGS_PROFILE_BIRTH_YEAR"),value:""},...Array.from(Array(61).keys()).map(e=>({name:(new Date).getFullYear()-10-e,value:(new Date).getFullYear()-10-e}))]},{className:"tm-select",name:"locationCountryId",label:e("SETTINGS_PROFILE_LOCATION"),type:"BaseSelect",validation:{required:!1},displayConditions:[{fieldName:"lang",values:["ru"]}],position:{row:"10",column:"1 / 7"},breakpoint:{1024:{position:{row:"5",column:"1 / 3"}}},options:a.length?h(e("SETTINGS_PROFILE_COUNTRY")).concat(a):h(e("SETTINGS_PROFILE_COUNTRY")),disabled:0===a.length},{className:"tm-select",name:"locationRegionId",type:"BaseSelect",validation:{required:!1},displayConditions:[{fieldName:"lang",values:["ru"]}],position:{row:"11",column:"1 / 7"},breakpoint:{1024:{position:{row:"5",column:"3 / 5"}}},options:i.length?h(e("SETTINGS_PROFILE_REGION")).concat(i):h(e("SETTINGS_PROFILE_REGION")),disabled:0===i.length},{className:"tm-select",name:"locationCityId",type:"BaseSelect",validation:{required:!1},position:{row:"12",column:"1 / 7"},breakpoint:{1024:{position:{row:"5",column:"5 / 7"}}},displayConditions:[{fieldName:"lang",values:["ru"]}],options:o.length?h(e("SETTINGS_PROFILE_CITY")).concat(o):h(e("SETTINGS_PROFILE_CITY")),disabled:0===o.length},{className:"tm-section",name:"contactSection",label:e("SETTINGS_PROFILE_CONTACTS"),description:e("SETTINGS_PROFILE_CONTACTS_HINT"),type:"BaseSection",position:{row:"13",column:"1 / 7"},breakpoint:{1024:{position:{row:"6",column:"1 / 7"}}}},{type:"DynamicInputs",name:"contacts",addLabel:e("SETTINGS_PROFILE_CONTACTS_ADD"),restoreText:e("SETTINGS_PROFILE_CONTACTS_PLACEHOLDER"),restoreLabel:e("SETTINGS_PROFILE_CONTACTS_PLACEHOLDER_ACTION"),fields:[{name:"contactTypeId",type:"BaseSelect",validation:{required:!0},defaultValue:"2",options:t},{name:"contactValue",type:"BaseInput",validation:{required:!1}},{className:"tm-checkbox",name:"showContactInSummaryCard",type:"BaseCheckbox",svgIcon:'<svg width="40" height="32" viewBox="0 0 40 32"><path d="M2 32h-2v-32h40v32h-38zm2-4h32v-24h-32v24zm4-8h24v4h-24v-4zm0-12h8v8h-8v-8zm12 0h12v4h-12v-4z"></path></svg>',validation:{required:!1}}],position:{row:"14",column:"1 / 7"},breakpoint:{1024:{position:{row:"7",column:"1 / 7"}}}},{className:"tm-section",name:"payments",label:e("SETTINGS_PROFILE_PAYMENTS"),description:e("SETTINGS_PROFILE_PAYMENTS_HINT"),type:"BaseSection",position:{row:"15",column:"1 / 7"},breakpoint:{1024:{position:{row:"8",column:"1 / 7"}}}},{className:"tm-input",label:e("SETTINGS_PROFILE_YANDEX_MONEY"),htmlAttrs:{placeholder:e("SETTINGS_PROFILE_YANDEX_MONEY_HINT")},name:"paymentYandexMoney",type:"BaseInput",validation:{required:!1,minLength:11,maxLength:20,pattern:"digits"},position:{row:"16",column:"1 / 7"},breakpoint:{1024:{labelLeft:!0,position:{row:"9",column:"1 / 7"}}}},{className:"tm-input",label:e("SETTINGS_PROFILE_PAYPAL"),htmlAttrs:{placeholder:e("SETTINGS_PROFILE_PAYPAL_HINT")},name:"paymentPayPalMe",type:"BaseInput",validation:{required:!1,minLength:3,maxLength:40},position:{row:"17",column:"1 / 7"},breakpoint:{1024:{labelLeft:!0,position:{row:"10",column:"1 / 7"}}}},{className:"tm-input",label:e("SETTINGS_PROFILE_WEBMONEY"),htmlAttrs:{placeholder:e("SETTINGS_PROFILE_WEBMONEY_HINT")},name:"paymentWebmoney",type:"BaseInput",validation:{required:!1,minLength:12,maxLength:12,pattern:"digits"},position:{row:"18",column:"1 / 7"},breakpoint:{1024:{labelLeft:!0,position:{row:"11",column:"1 / 7"}}}},{className:"tm-textarea",description:e("SETTINGS_PROFILE_ABOUT_HINT"),label:e("SETTINGS_PROFILE_ABOUT"),name:"description",type:"BaseTextarea",validation:{required:!1},position:{row:"19",column:"1 / 7"},breakpoint:{1024:{position:{row:"12",column:"1 / 7"}}}}];var O={components:{TMFormBuilder:n["a"],TMPlaceholder:r["a"],TMPage:l["a"],TMUserSettingsTabs:m["a"],TMSectionName:T["a"]},data(){return{fields:[],initialData:u,prevGeoData:{},contactTypeRefs:[],countriesRefs:[],regionsRefs:[],isDataLoading:!0,isSubmitLoading:!1}},computed:{isProfileForm(){return"USER_SETTINGS_PROFILE"===this.$route.name},isPrivacyForm(){return"USER_SETTINGS_PRIVACY"===this.$route.name},isNotificationsForm(){return"USER_SETTINGS_NOTIFICATIONS"===this.$route.name},isMiscForm(){return"USER_SETTINGS_MISC"===this.$route.name},currentTitle(){return this.isProfileForm?this.msg("SETTINGS_PROFILE_TITLE"):this.isPrivacyForm?this.msg("SETTINGS_PRIVACY_TITLE"):this.isNotificationsForm?this.msg("SETTINGS_NOTIFICATIONS_TITLE"):this.isMiscForm?this.msg("SETTINGS_MISC_TITLE"):""}},mounted(){let e;this.isProfileForm&&(e=this.loadProfileForm),this.isPrivacyForm&&(e=this.loadPrivacyForm),this.isNotificationsForm&&(e=this.loadNotificationsForm),this.isMiscForm&&(e=this.loadMiscForm),e().then(this.markDataLoaded).catch(e=>this.showError({error:e}))},methods:{...Object(s["b"])("me",["init"]),...Object(s["b"])("ssr",["markDataLoaded","showError"]),loadPrivacyForm(){return Object(c["v"])("privacy").then(e=>{this.fields=d(this.msg),this.initialData={...N,...e},this.isDataLoading=!1})},loadMiscForm(){return Object(c["v"])("misc").then(e=>{this.fields=S(this.msg),this.initialData={...I,...e},this.isDataLoading=!1})},loadNotificationsForm(){return Object(c["v"])("notifications").then(e=>{this.fields=_(this.msg),this.initialData={...E,...e},this.isDataLoading=!1})},loadProfileForm(){return Promise.all([Object(c["v"])("profile"),Object(c["e"])(),Object(c["f"])()]).then(([e,t,a])=>{const{contactTypeRefs:i}=t;this.contactTypeRefs=i;const o=a.pointRefs;return this.countriesRefs=o,this.fields=p(this.msg,i,o),e}).then(e=>{const{locationRegionId:t,locationCountryId:a}=e;return a?this.updateRegions(a).then(()=>(t&&this.updateCities(a,t),e)):e}).then(e=>{this.initialData=e,this.initialData.lang=this.langOptions.hl,this.isDataLoading=!1})},proceedForm(e){let t;return this.isSubmitLoading=!0,this.isProfileForm&&(t="profile"),this.isPrivacyForm&&(t="privacy"),this.isNotificationsForm&&(t="notifications"),this.isMiscForm&&(t="misc"),Object(c["I"])(e,t).then(()=>{this.isSubmitLoading=!1,this.$toast.success(this.msg("SETTINGS_SUCCESS")),this.init({force:!0}),window.scrollTo({top:0,behavior:"smooth"})}).catch(e=>{this.isSubmitLoading=!1,this.$toast.error(e.message)})},updateRegions(e){return Object(c["g"])(e).then(e=>{const t=e.pointRefs;this.regionsRefs=t,this.fields=p(this.msg,this.contactTypeRefs,this.countriesRefs,t)})},updateCities(e,t){return Object(c["d"])(e,t).then(e=>{const t=e.pointRefs;this.fields=p(this.msg,this.contactTypeRefs,this.countriesRefs,this.regionsRefs,t)})},formUpdateTempData(e){if(e.avatarImageUrl){this.isSubmitLoading=!0;const t=new FormData;t.append("file",e.avatarImageUrl,e.avatarImageUrl.name),t.set("t","avatar_image"),Object(c["E"])(t).then(e=>{this.isSubmitLoading=!1,this.initialData={...this.initialData,avatarImageUrl:e.url}}).catch(e=>{this.isSubmitLoading=!1,this.$toast.error(e.message)})}},onDataUpdate(e){if(e.locationCountryId!==this.initialData.locationCountryId){this.initialData={...e,locationRegionId:null,locationCityId:null};const{locationCountryId:t}=e;this.updateRegions(t)}else if(e.locationRegionId!==this.initialData.locationRegionId){this.initialData={...e,locationCityId:null};const{locationCountryId:t,locationRegionId:a}=e;this.updateCities(t,a)}else this.initialData=e}},metaInfo(){return{title:this.currentTitle}}},L=O,b=(a("683e"),a("2877")),R=Object(b["a"])(L,i,o,!1,null,null,null);t["default"]=R.exports},"58a5":function(e,t,a){},6223:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TMTabs",{staticClass:"tm-tabs_page-header",attrs:{tabs:e.tabs}})},o=[],s=a("b92c"),n={name:"TMUserSettingsTabs",components:{TMTabs:s["a"]},computed:{tabs(){return[{title:this.msg("SETTINGS_PROFILE_TITLE"),route:{name:"USER_SETTINGS_PROFILE"}},{title:this.msg("SETTINGS_ACCOUNT_TITLE"),route:{path:"https://account.habr.com/settings/",external:!0,target:"_blank"}},{title:this.msg("SETTINGS_PRIVACY_TITLE"),route:{name:"USER_SETTINGS_PRIVACY"}},{title:this.msg("SETTINGS_NOTIFICATIONS_TITLE"),route:{name:"USER_SETTINGS_NOTIFICATIONS"}},{title:this.msg("SETTINGS_APPS_TITLE"),route:{name:"USER_SETTINGS_APPS"}},{title:this.msg("SETTINGS_MISC_TITLE"),route:{name:"USER_SETTINGS_MISC"}}]}}},l=n,r=(a("fe8a"),a("2877")),T=Object(r["a"])(l,i,o,!1,null,null,null);t["a"]=T.exports},"683e":function(e,t,a){"use strict";a("b18f")},b18f:function(e,t,a){},fe8a:function(e,t,a){"use strict";a("58a5")}}]);
//# sourceMappingURL=user-settings.586659b6.js.map